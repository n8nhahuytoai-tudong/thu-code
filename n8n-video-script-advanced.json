{
  "name": "Video Script Generator Advanced - PhiÃªn Báº£n NÃ¢ng Cao",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "video-script-generator",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-trigger-001",
      "name": "Webhook Trigger",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [240, 300],
      "webhookId": "video-script-webhook"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "param-001",
              "name": "topic",
              "value": "={{ $json.body.topic || $json.body.video_topic || \"Chá»§ Ä‘á» máº·c Ä‘á»‹nh\" }}",
              "type": "string"
            },
            {
              "id": "param-002",
              "name": "duration",
              "value": "={{ $json.body.duration || $json.body.video_duration || \"5-7 phÃºt\" }}",
              "type": "string"
            },
            {
              "id": "param-003",
              "name": "audience",
              "value": "={{ $json.body.audience || $json.body.target_audience || \"NgÆ°á»i xem chung\" }}",
              "type": "string"
            },
            {
              "id": "param-004",
              "name": "style",
              "value": "={{ $json.body.style || $json.body.video_style || \"ChuyÃªn nghiá»‡p\" }}",
              "type": "string"
            },
            {
              "id": "param-005",
              "name": "platform",
              "value": "={{ $json.body.platform || \"YouTube\" }}",
              "type": "string"
            },
            {
              "id": "param-006",
              "name": "language",
              "value": "={{ $json.body.language || \"Tiáº¿ng Viá»‡t\" }}",
              "type": "string"
            },
            {
              "id": "param-007",
              "name": "tone",
              "value": "={{ $json.body.tone || \"ThÃ¢n thiá»‡n, nhiá»‡t tÃ¬nh\" }}",
              "type": "string"
            },
            {
              "id": "param-008",
              "name": "include_seo",
              "value": "={{ $json.body.include_seo || true }}",
              "type": "boolean"
            }
          ]
        }
      },
      "id": "extract-params-001",
      "name": "Extract Parameters",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [460, 300]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "prompt-001",
              "name": "ai_prompt",
              "value": "=# NHIá»†M Vá»¤: Viáº¿t Ká»‹ch Báº£n Video ChuyÃªn Nghiá»‡p\n\nBáº¡n lÃ  má»™t chuyÃªn gia viáº¿t ká»‹ch báº£n video vá»›i 10+ nÄƒm kinh nghiá»‡m.\n\n## THÃ”NG TIN VIDEO\n\nðŸŽ¯ **Chá»§ Ä‘á»**: {{ $json.topic }}\nâ±ï¸ **Thá»i lÆ°á»£ng**: {{ $json.duration }}\nðŸ‘¥ **Äá»‘i tÆ°á»£ng**: {{ $json.audience }}\nðŸŽ¨ **Phong cÃ¡ch**: {{ $json.style }}\nðŸ“± **Platform**: {{ $json.platform }}\nðŸŒ **NgÃ´n ngá»¯**: {{ $json.language }}\nðŸŽ­ **Tone**: {{ $json.tone }}\nðŸ“Š **SEO**: {{ $json.include_seo ? 'CÃ³' : 'KhÃ´ng' }}\n\n## Cáº¤U TRÃšC Ká»ŠCH Báº¢N YÃŠU Cáº¦U\n\n### 1. METADATA\n- TiÃªu Ä‘á» video (catchy, cÃ³ keyword)\n- MÃ´ táº£ ngáº¯n (2-3 cÃ¢u)\n- Hashtags phÃ¹ há»£p\n- Thumbnail ideas\n{{ $json.include_seo ? '- SEO keywords chÃ­nh vÃ  phá»¥\\n- Title alternatives (A/B testing)' : '' }}\n\n### 2. PRE-PRODUCTION NOTES\n- Thiáº¿t bá»‹ cáº§n thiáº¿t\n- Äá»‹a Ä‘iá»ƒm quay\n- Props/Ä‘á»“ dÃ¹ng\n- Trang phá»¥c phÃ¹ há»£p\n\n### 3. SCRIPT CHÃNH\n\n#### A. HOOK (0-15 giÃ¢y) âš¡\n- Pattern interrupt máº¡nh máº½\n- Statement hoáº·c cÃ¢u há»i kÃ­ch thÃ­ch tÃ² mÃ²\n- Visual hook (gá»£i Ã½ hÃ¬nh áº£nh thu hÃºt)\n\n**Format**:\n```\n[00:00-00:15] HOOK\nVisual: [MÃ´ táº£ cáº£nh quay]\nVoiceover: \"[Lá»i thoáº¡i]\"\nText on screen: \"[Text overlay]\"\nMusic: [Kiá»ƒu nháº¡c phÃ¹ há»£p]\n```\n\n#### B. INTRO (15-45 giÃ¢y) ðŸ‘‹\n- Giá»›i thiá»‡u báº£n thÃ¢n/kÃªnh (náº¿u cáº§n)\n- NÃªu váº¥n Ä‘á»/giÃ¡ trá»‹ video mang láº¡i\n- Preview ná»™i dung chÃ­nh\n- CTA subscribe (náº¿u lÃ  YouTube)\n\n#### C. Ná»˜I DUNG CHÃNH (60-80% thá»i lÆ°á»£ng) ðŸ“š\n\nChia thÃ nh 3-5 pháº§n rÃµ rÃ ng:\n\n**Pháº§n 1**: [TiÃªu Ä‘á»]\n- [MM:SS-MM:SS] \n- Ná»™i dung chi tiáº¿t\n- VÃ­ dá»¥ cá»¥ thá»ƒ\n- B-roll suggestions\n- Transitions\n\n**Pháº§n 2**: [TiÃªu Ä‘á»]\n...\n\n{{ $json.platform === 'TikTok' || $json.platform === 'YouTube Shorts' || $json.platform === 'Instagram Reels' ? '**LÆ¯U Ã**: Format ngáº¯n, dynamic cuts má»—i 2-3 giÃ¢y, trending sounds' : '' }}\n\n#### D. Káº¾T LUáº¬N (30-60 giÃ¢y) ðŸŽ\n- TÃ³m táº¯t key takeaways\n- Reinforce main message\n- Emotional ending (náº¿u phÃ¹ há»£p)\n\n#### E. CALL TO ACTION (15-30 giÃ¢y) ðŸ“¢\n- Primary CTA (subscribe, follow, like)\n- Secondary CTA (comment, share, check description)\n- Teaser video tiáº¿p theo (náº¿u cÃ³ series)\n\n### 4. POST-PRODUCTION NOTES\n- Gá»£i Ã½ mÃ u grading\n- Music/SFX timing\n- Text animations\n- Transitions style\n- End screen elements\n\n### 5. ENGAGEMENT STRATEGY\n- Pinned comment suggestion\n- Community post ideas\n- Response template cho comments\n\n{{ $json.include_seo ? '### 6. SEO OPTIMIZATION\\n- Title (60-70 kÃ½ tá»±)\\n- Description (first 150 characters critical)\\n- Tags (10-15 tags)\\n- Chapters/Timestamps\\n- Custom thumbnail text' : '' }}\n\n## GUIDELINES\n\nâœ… **Pháº£i cÃ³**:\n- Timestamps chÃ­nh xÃ¡c cho má»i pháº§n\n- Natural language (trÃ¡nh quÃ¡ ká»‹ch báº£n hÃ³a)\n- Personality phÃ¹ há»£p vá»›i target audience\n- Clear pacing (khÃ´ng quÃ¡ nhanh/cháº­m)\n- Visual variety (mix talking head, B-roll, graphics)\n\nâŒ **TrÃ¡nh**:\n- Generic opening (\"Hi guys, today...\")\n- QuÃ¡ nhiá»u filler words\n- Máº¥t focus chá»§ Ä‘á» chÃ­nh\n- CTA quÃ¡ aggressive\n- Copyright music/content\n\n## OUTPUT FORMAT\n\nHÃ£y output dÆ°á»›i dáº¡ng Markdown rÃµ rÃ ng, dá»… Ä‘á»c, vá»›i:\n- Headers vÃ  subheaders rÃµ rÃ ng\n- Bullet points\n- Timestamps format [MM:SS]\n- Bold/italic cho emphasis\n- Emoji phÃ¹ há»£p (nhÆ°ng khÃ´ng láº¡m dá»¥ng)\n\n---\n\n**Báº®T Äáº¦U Táº O Ká»ŠCH Báº¢N NGAY BÃ‚Y GIá»œ!**",
              "type": "string"
            }
          ]
        }
      },
      "id": "build-prompt-001",
      "name": "Build Advanced Prompt",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": false
          },
          "conditions": [
            {
              "id": "ai-provider-openai",
              "leftValue": "={{ $json.platform }}",
              "rightValue": "YouTube",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "route-by-platform-001",
      "name": "Route by Platform",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [900, 300]
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "message",
        "modelId": {
          "__rl": true,
          "value": "gpt-4-turbo-preview",
          "mode": "list"
        },
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "Báº¡n lÃ  chuyÃªn gia viáº¿t ká»‹ch báº£n video vá»›i 10 nÄƒm kinh nghiá»‡m. Báº¡n giá»i táº¡o content viral, engaging vÃ  cÃ³ cáº¥u trÃºc rÃµ rÃ ng."
            },
            {
              "role": "user",
              "content": "={{ $('Build Advanced Prompt').item.json.ai_prompt }}"
            }
          ]
        },
        "options": {
          "temperature": 0.8,
          "maxTokens": 6000,
          "topP": 0.9,
          "frequencyPenalty": 0.3,
          "presencePenalty": 0.3
        }
      },
      "id": "openai-long-form-001",
      "name": "OpenAI - Long Form",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.3,
      "position": [1120, 200],
      "credentials": {
        "openAiApi": {
          "id": "YOUR_OPENAI_CREDENTIAL_ID",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "resource": "text",
        "operation": "message",
        "modelId": {
          "__rl": true,
          "value": "gpt-4-turbo-preview",
          "mode": "list"
        },
        "messages": {
          "values": [
            {
              "role": "system",
              "content": "Báº¡n lÃ  chuyÃªn gia táº¡o ná»™i dung short-form video cho TikTok, Instagram Reels, YouTube Shorts. Báº¡n hiá»ƒu rÃµ trending formats, hooks viral, vÃ  cÃ¡ch giá»¯ attention trong 60 giÃ¢y."
            },
            {
              "role": "user",
              "content": "={{ $('Build Advanced Prompt').item.json.ai_prompt }}\n\nQUAN TRá»ŒNG: Tá»‘i Æ°u hÃ³a cho short-form video:\n- Hook trong 1-2 giÃ¢y Ä‘áº§u tiÃªn\n- Cut má»—i 2-3 giÃ¢y\n- Text on screen for no-sound viewing\n- Trending music/sounds\n- Vertical format 9:16"
            }
          ]
        },
        "options": {
          "temperature": 0.9,
          "maxTokens": 3000,
          "topP": 0.95,
          "frequencyPenalty": 0.5,
          "presencePenalty": 0.4
        }
      },
      "id": "openai-short-form-001",
      "name": "OpenAI - Short Form",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.3,
      "position": [1120, 400],
      "credentials": {
        "openAiApi": {
          "id": "YOUR_OPENAI_CREDENTIAL_ID",
          "name": "OpenAI API"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combinationMode": "mergeByPosition",
        "options": {}
      },
      "id": "merge-scripts-001",
      "name": "Merge Scripts",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [1340, 300]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "format-001",
              "name": "script_content",
              "value": "={{ $json.message?.content || $json.choices?.[0]?.message?.content || \"\" }}",
              "type": "string"
            },
            {
              "id": "format-002",
              "name": "metadata",
              "value": "={{ {\n  topic: $('Extract Parameters').item.json.topic,\n  duration: $('Extract Parameters').item.json.duration,\n  platform: $('Extract Parameters').item.json.platform,\n  language: $('Extract Parameters').item.json.language,\n  audience: $('Extract Parameters').item.json.audience,\n  style: $('Extract Parameters').item.json.style,\n  tone: $('Extract Parameters').item.json.tone,\n  generated_at: $now.toISO(),\n  word_count: ($json.message?.content || \"\").split(' ').length,\n  estimated_speaking_time: Math.round(($json.message?.content || \"\").split(' ').length / 150) + \" phÃºt\"\n} }}",
              "type": "object"
            },
            {
              "id": "format-003",
              "name": "file_name_base",
              "value": "={{ 'video-script-' + $('Extract Parameters').item.json.topic.toLowerCase().replace(/[^a-z0-9]/g, '-').substring(0, 50) + '-' + $now.format('yyyy-MM-dd-HHmmss') }}",
              "type": "string"
            }
          ]
        }
      },
      "id": "format-output-001",
      "name": "Format Output",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [1560, 300]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "quality-check-001",
              "name": "quality_score",
              "value": "={{ \n  let score = 0;\n  const content = $json.script_content || \"\";\n  \n  // Check for timestamps\n  if (content.match(/\\[\\d{2}:\\d{2}/g)?.length > 3) score += 20;\n  \n  // Check for sections\n  if (content.match(/#{2,3}\\s/g)?.length > 3) score += 20;\n  \n  // Check for B-roll mentions\n  if (content.toLowerCase().includes('b-roll') || content.toLowerCase().includes('visual')) score += 15;\n  \n  // Check for CTA\n  if (content.toLowerCase().includes('call to action') || content.toLowerCase().includes('cta')) score += 15;\n  \n  // Check length\n  const wordCount = content.split(' ').length;\n  if (wordCount > 500 && wordCount < 3000) score += 15;\n  \n  // Check for Hook section\n  if (content.toLowerCase().includes('hook')) score += 15;\n  \n  return score;\n}}",
              "type": "number"
            },
            {
              "id": "quality-check-002",
              "name": "quality_feedback",
              "value": "={{ \n  const score = $json.quality_score || 0;\n  if (score >= 80) return 'âœ… Excellent - Script Ä‘áº¡t cháº¥t lÆ°á»£ng cao!';\n  if (score >= 60) return 'âœ… Good - Script tá»‘t, cÃ³ thá»ƒ cáº£i thiá»‡n má»™t chÃºt';\n  if (score >= 40) return 'âš ï¸ Fair - Script cáº§n bá»• sung thÃªm chi tiáº¿t';\n  return 'âŒ Poor - Script cáº§n viáº¿t láº¡i';\n}}",
              "type": "string"
            },
            {
              "id": "quality-check-003",
              "name": "suggestions",
              "value": "={{ \n  const content = $json.script_content || \"\";\n  let suggestions = [];\n  \n  if (!content.toLowerCase().includes('hook')) suggestions.push('ThÃªm pháº§n HOOK Ä‘á»ƒ thu hÃºt ngÆ°á»i xem');\n  if (!content.match(/\\[\\d{2}:\\d{2}/g)) suggestions.push('ThÃªm timestamps cho cÃ¡c pháº§n');\n  if (!content.toLowerCase().includes('b-roll')) suggestions.push('ThÃªm gá»£i Ã½ B-roll visuals');\n  if (!content.toLowerCase().includes('cta') && !content.toLowerCase().includes('call to action')) suggestions.push('ThÃªm Call-to-Action rÃµ rÃ ng');\n  \n  return suggestions.length > 0 ? suggestions : ['KhÃ´ng cÃ³ gá»£i Ã½ - Script Ä‘Ã£ hoÃ n thiá»‡n!'];\n}}",
              "type": "array"
            }
          ]
        }
      },
      "id": "quality-check-001",
      "name": "Quality Check",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [1780, 300]
    },
    {
      "parameters": {
        "operation": "toJson",
        "mode": "each",
        "options": {
          "fileName": "={{ $json.file_name_base }}.json"
        }
      },
      "id": "save-json-001",
      "name": "Save JSON",
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [2000, 200]
    },
    {
      "parameters": {
        "operation": "text",
        "options": {
          "fileName": "={{ $json.file_name_base }}.md"
        }
      },
      "id": "save-markdown-001",
      "name": "Save Markdown",
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [2000, 300]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "response-001",
              "name": "status",
              "value": "success",
              "type": "string"
            },
            {
              "id": "response-002",
              "name": "message",
              "value": "Ká»‹ch báº£n video Ä‘Ã£ Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng!",
              "type": "string"
            },
            {
              "id": "response-003",
              "name": "data",
              "value": "={{ {\n  script: $('Format Output').item.json.script_content,\n  metadata: $('Format Output').item.json.metadata,\n  quality: {\n    score: $('Quality Check').item.json.quality_score,\n    feedback: $('Quality Check').item.json.quality_feedback,\n    suggestions: $('Quality Check').item.json.suggestions\n  },\n  files: {\n    json: $('Format Output').item.json.file_name_base + '.json',\n    markdown: $('Format Output').item.json.file_name_base + '.md'\n  }\n} }}",
              "type": "object"
            }
          ]
        }
      },
      "id": "prepare-response-001",
      "name": "Prepare Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.2,
      "position": [2220, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ $json }}",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        }
      },
      "id": "webhook-response-001",
      "name": "Webhook Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [2440, 300]
    }
  ],
  "connections": {
    "Webhook Trigger": {
      "main": [
        [
          {
            "node": "Extract Parameters",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Parameters": {
      "main": [
        [
          {
            "node": "Build Advanced Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Build Advanced Prompt": {
      "main": [
        [
          {
            "node": "Route by Platform",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route by Platform": {
      "main": [
        [
          {
            "node": "OpenAI - Long Form",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OpenAI - Short Form",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI - Long Form": {
      "main": [
        [
          {
            "node": "Merge Scripts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI - Short Form": {
      "main": [
        [
          {
            "node": "Merge Scripts",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge Scripts": {
      "main": [
        [
          {
            "node": "Format Output",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Output": {
      "main": [
        [
          {
            "node": "Quality Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Quality Check": {
      "main": [
        [
          {
            "node": "Save JSON",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save Markdown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save JSON": {
      "main": [
        [
          {
            "node": "Prepare Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Save Markdown": {
      "main": [
        [
          {
            "node": "Prepare Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Response": {
      "main": [
        [
          {
            "node": "Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": ""
  },
  "staticData": null,
  "tags": [
    {
      "id": "1",
      "name": "Video Production"
    },
    {
      "id": "2",
      "name": "AI Content"
    },
    {
      "id": "3",
      "name": "Advanced"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-11-07T00:00:00.000Z",
  "versionId": "advanced-v1"
}
